<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Song Requests</title>
  <link rel="stylesheet" href="dock.css" />
  <script src="https://cdn.jsdelivr.net/npm/comfy.js@1.1.6/dist/comfy.min.js"></script>
</head>
<body>
  <header class="dock-header">
    <h1 class="dock-title">Song Requests</h1>
    <span id="queueCount" class="queue-count">0 in queue</span>
  </header>

  <div class="tabs" role="tablist">
    <button type="button" class="tab active" id="tabQueue" role="tab" aria-selected="true" aria-controls="panelQueue">Queue</button>
    <button type="button" class="tab" id="tabSpinner" role="tab" aria-selected="false" aria-controls="panelSpinner">Spin the Wheel</button>
  </div>

  <div id="panelQueue" class="tab-panel active" role="tabpanel">
    <section class="now-playing" id="nowPlayingCard">
      <h2 class="section-heading">Now Playing</h2>
      <div class="now-playing-content">
        <div class="now-playing-thumb" id="nowPlayingThumb"></div>
        <div class="now-playing-info">
          <p class="now-playing-title" id="nowPlayingTitle">‚Äî</p>
          <p class="now-playing-requested" id="nowPlayingRequestedBy">Requested by ‚Äî</p>
          <div class="progress-wrap">
            <div class="progress-bar" id="progressBar"><span class="progress-fill" id="progressFill"></span></div>
            <span class="progress-times"><span id="progressCurrent">0:00</span> / <span id="progressDuration">0:00</span></span>
          </div>
          <div class="now-playing-controls">
            <button type="button" id="stopQueue" class="icon-btn" title="Pause">Pause</button>
            <button type="button" id="startQueue" class="icon-btn" title="Play">Play</button>
            <button type="button" id="skipNext" class="icon-btn" title="Skip">Skip</button>
            <div class="volume-wrap">
              <label for="volumeSlider" class="visually-hidden">Volume</label>
              <input type="range" id="volumeSlider" min="0" max="100" value="100" />
            </div>
            <button type="button" id="showVideoToggle" class="icon-btn eye-toggle" title="Show video on overlay" aria-label="Show video on overlay" aria-pressed="false">üëÅ</button>
          </div>
        </div>
      </div>
    </section>

    <section class="add-song">
      <h2 class="section-heading">Add Song</h2>
      <div class="add-song-row">
        <input type="text" id="urlInput" placeholder="YouTube URL or search..." aria-label="YouTube URL" />
        <button type="button" id="addUrl" class="btn-add" title="Add">+</button>
      </div>
      <p class="connection-status" id="statusText">Waiting for player</p>
      <div class="toolbar">
        <button type="button" id="clearQueue" class="toolbar-btn" title="Clear queue">Clear</button>
        <button type="button" id="settingsToggle" class="toolbar-btn" title="Settings">Settings</button>
      </div>
    </section>

    <section class="queue-section">
      <h2 class="section-heading">Queue</h2>
      <ul id="queueList" class="queue-list">
        <li class="queue-empty">Queue empty</li>
      </ul>
    </section>
  </div>

  <div id="panelSpinner" class="tab-panel" role="tabpanel" hidden>
    <section class="spin-section">
      <div class="spin-section-header">
        <h2 class="section-heading">Spin the Wheel</h2>
        <button type="button" id="showWheelOnStreamBtn" class="icon-btn spin-wheel-stream-toggle" title="Show wheel on stream" aria-pressed="false" aria-label="Show wheel on stream">üëÅ</button>
      </div>
      <p class="spin-hint" id="spinHint">Add songs to the queue, then spin to pick one.</p>
      <div class="spin-wheel-wrap" id="spinWheelWrap" hidden>
        <canvas id="spinWheelCanvas" class="spin-wheel-canvas" width="240" height="240" aria-hidden="true"></canvas>
        <div class="spin-wheel-pointer" aria-hidden="true"></div>
      </div>
      <div class="spin-result" id="spinResult" hidden>
        <p class="spin-winner-label">Winner</p>
        <p class="spin-winner-title" id="spinWinnerTitle">‚Äî</p>
        <button type="button" id="spinPlayWinner" class="btn-spin">Play this song</button>
      </div>
      <button type="button" id="spinBtn" class="btn-spin" disabled>SPIN!</button>
    </section>
  </div>

  <aside id="settingsPanel" class="settings-panel" aria-hidden="true">
    <div class="settings-header">
      <h2>Settings</h2>
      <button type="button" id="settingsClose" class="icon-btn" aria-label="Close">√ó</button>
    </div>
    <p class="settings-twitch-label"><span id="twitchChannelLabel">Twitch: #adjstreams</span> <span id="twitchStatus">Connecting‚Ä¶</span></p>
    <label for="configChannel">Twitch channel</label>
    <input type="text" id="configChannel" placeholder="adjstreams" />
    <label for="configCommand">Command prefix (without !)</label>
    <input type="text" id="configCommand" placeholder="sr" />
    <button type="button" id="configSave">Save and reconnect</button>
    <button type="button" id="twitchDisconnect">Disconnect from Twitch</button>
  </aside>

  <div id="settingsOverlay" class="settings-overlay" aria-hidden="true"></div>

  <script src="dock.js"></script>
</body>
</html>
